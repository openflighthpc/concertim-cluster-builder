# The kind or type of this cluster template.  Currently this can be `heat`.
kind: heat

# Brief description of the purpose of the cluster.
title: Database Clustering

# Fuller description of the purpose of the cluster and how to use it.
description: |
  Create a high-availability database cluster using MySQL/MariaDB Galera,
  PostgreSQL with Patroni, or Cassandra.

  Once the database cluster is ready...

# The parameters to expose through Concertim.  This could be the full set of
# parameters for the HEAT template or a subset.  It is a template author error
# to have parameters here that are not present in the heat template.
#
# Perhaps this could read the parameters directly from the HEAT template instead.
# Perhaps this could provide a mechanism to expose those parameters.
# If so, we should probably support adding label, description and constraints.
parameters:
  clustername:
    type: string
    label: Cluster name
    description: The name your cluster should be given
    default: mycluster
    constraints:
      - length: { min: 6, max: 255 }
        description: Cluster name must be between 6 and 255 characters
      - allowed_pattern: "[a-zA-Z]+[a-zA-Z0-9\\-\\_]*"
        description: Cluster name can contain only alphanumeric characters, hyphens and underscores

  count:
    type: number
    label: Number of database replicas
    description: How many replicas should your cluster contain?
    default: 3
    constraints:
      - range: { min: 1 }
        description: Number of replicas cannot be less than one

  database-flavour:
    type: string
    label: Database flavour
    description: Which database flavour do you want?
    default: m1.small
    constraints:
      - allowed_values:
        - MariaDB
        - PostgreSQL
        - Cassandra

  node-flavour:
    type: string
    label: Node flavour
    description: Which flavour should be be used for the database servers?
    default: m1.small
    constraints:
      - allowed_values:
        - m1.small
        - m1.medium
        - m1.large
        - m1.xxlarge
        - m1.xxxlarge


# Below here we have a list of attributes that are specific to a given cluster
# type.  That is HOT/HEAT will have different attributes than, say, sahara.
#
# Perhaps these need to have already been checked out.  Or perhaps they can be
# specified as a URL in the API call to HOT.
#
# Some templates such as those used in cluster-building-blocks are created from
# multiple HEAT templates.  Need to consider how that is going to be handled.
heat_template_url: path or URL to heat template to use for this cluster type
