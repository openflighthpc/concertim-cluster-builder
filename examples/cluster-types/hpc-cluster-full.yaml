# Brief description of the purpose of the cluster.
title: High-Performance Computing (HPC full)

# Fuller description of the purpose of the cluster and how to use it.
description: |
  Launch a cluster for standard HPC workflows.  The cluster will run a Slurm
  scheduler for managing HPC jobs workloads.  The latest version of Flight User
  suite and Flight Web suite will be installed.

  Once the cluster is ready you will be able to access it via SSH using the SSH
  key you have configured, or through the Flight Web suite.


# The parameters to expose through Concertim.  This could be the full set of
# parameters for the HEAT template or a subset.  It is a template author error
# to have parameters here that are not present in the heat template.
#
# Perhaps this could read the parameters directly from the HEAT template instead.
# Perhaps this could provide a mechanism to expose those parameters.
# If so, we should probably support adding label, description and constraints.
parameters:
  clustername:
    type: string
    label: Cluster name
    description: The name to give the cluster
    constraints:
      - length: { min: 6, max: 255 }
        description: Cluster name must be between 6 and 255 characters
      - allowed_pattern: "^[a-zA-Z][a-zA-Z0-9\\-_]*$"
        description: Cluster name can contain only alphanumeric characters, hyphens and underscores

  external-network:
    type: string
    label: External Network Name
    description: The name of the external network to bridge network to
    default: public1

  network-cidr-pri:
    type: string
    label: Primary Nework CIDR
    description: Network CIDR to be used for primary network
    default: "10.100.0.0/16"

  ssh-key:
    type: string
    label: SSH Key for Access

  solo-image:
    type: string
    label: Flight Solo Image ID
    default: "Flight Solo 2023.2"

  gateway-pri-ip:
    type: string
    label: Gateway Primary IP Address

  gateway-flavour:
    type: string
    label: Gateway node flavour
    default: m1.medium
    
  infra01-create:
    type: boolean
    label: Create Infra01 Node?
    default: True

  infra01-pri-ip:
    type: string
    label: Infra01 Primary IP Address

  infra01-flavour:
    type: string
    label: Infra01 node flavour
    default: m1.small

  infra02-create:
    type: boolean
    label: Create Infra02 Node?
    default: False

  infra02-pri-ip:
    type: string
    label: Infra02 Primary IP Address

  infra02-flavour:
    type: string
    label: Infra02 node flavour
    default: m1.small

  storage1-create:
    type: boolean
    label: Create Storage1 Node?
    default: False

  storage1-pri-ip:
    type: string
    label: Storage1 Primary IP Address

  storage1-flavour:
    type: string
    label: Storage1 node flavour
    default: m1.medium

  storage1-mount-disk-size:
    type: string
    label: Storage1 mounted disk size


# The kind or type of this cluster template.
kind: heat

# The path to the HOT template to use for this cluster-type.
#
# Paths are relative to the `hot` directory in the Flask servers instance path
# directory.
#
# Currently, each cluster type supports running a single HOT template.
heat_template_url: cluster-building-blocks/hpc-core-full.yaml
